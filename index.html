<!DOCTYPE html>
<html lang="ko">
  <head>
    <!-- OG Tag -->
    <meta property="og:title" content="ğŸ“ Memo" />
    <meta property="og:description" content="ë°°í¬ê°€ 3000ë§Œë…„ ê±¸ë¦° ë‚¡ì€ ë©”ëª¨ì¥..." />
    <meta property="og:image" content="..." />

    <!-- Favicon -->
    <link
      rel="icon"
      type="image/png"
      href="./img/favicon-96x96.png"
      sizes="96x96"
    />
    <link rel="icon" type="image/svg+xml" href="./img/favicon.svg" />
    <link rel="shortcut icon" href="./img/favicon.ico" />
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="./img/apple-touch-icon.png"
    />

    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TODAY'S MEMO</title>
    <!-- ì™¸ë¶€ CSS íŒŒì¼ ì—°ê²° -->
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="container">
      <header>
        <h1>ğŸ“ Today's MEMO ğŸ“</h1>
        <p class="main-text-p">
          ë©”ëª¨ë¥¼ ë‹¤ì‹œ ë³´ê³  ì‹¶ë‹¤ë©´ "ë¡œì»¬ ì €ì¥"ì„ í´ë¦­í•˜ì„¸ìš” <br />
          ğŸš¨ ì£¼ì˜! ì‚­ì œë¥¼ ëˆ„ë¥´ë©´ ë©”ëª¨ê°€ ì˜ì›íˆ ì‚¬ë¼ì§‘ë‹ˆë‹¤.
        </p>
      </header>

      <div class="form-body">
        <form id="controller">
          <label>
            ë©”ëª¨ ë‚´ìš©:
            <input name="memoText" type="text" required />
          </label>
          <label>
            ë°°ê²½ ìƒ‰ìƒ:
            <input id="colorInput" name="memoBgColor" type="color" />
          </label>
          <button type="submit">ì¶”ê°€ âœ’ï¸</button>
        </form>
      </div>

      <section id="view"></section>
    </div>

    <script>
      function onload() {
        // ëœë¤í•œ ë°ì€ ìƒ‰ìƒ ìƒì„± (ìƒ‰ìƒ ì…ë ¥ ì´ˆê¸°ê°’ìš©)
        function goodBgColor() {
          return `#${[...Array(3)]
            .map(() => Math.floor(Math.random() * 56) + 200)
            .map((v) => v.toString(16).padStart(2, "0"))
            .join("")}`;
        }
        document.querySelector("#colorInput").value = goodBgColor();

        // ë¡œì»¬ ë° ì„¸ì…˜ì— ì €ì¥ëœ ë©”ëª¨ë¥¼ í•©ì¹œ ë°°ì—´
        const memoData = [
          ...(JSON.parse(localStorage.getItem("memoStorage")) ?? []),
          ...(JSON.parse(sessionStorage.getItem("memoStorage")) ?? []),
        ];

        function drawMemo() {
          const view = document.querySelector("#view");
          view.innerHTML = "";
          for (const memo of memoData) {
            // memoElementì— ì¹´ë“œ í´ë˜ìŠ¤ ì¶”ê°€
            const memoElement = document.createElement("div");
            memoElement.classList.add("memo-card");
            // ë°°ê²½ìƒ‰ì€ ì‚¬ìš©ìê°€ ì„ íƒí•œ ìƒ‰ìƒ ì ìš© (ì¸ë¼ì¸ ìŠ¤íƒ€ì¼ì€ ìš°ì„ ìˆœìœ„ê°€ ë†’ìŠµë‹ˆë‹¤)
            memoElement.style.backgroundColor = memo.bgColor;

            // ë©”ëª¨ í…ìŠ¤íŠ¸ëŠ” <p> íƒœê·¸ë¡œ ê°ì‹¸ê¸°
            const memoText = document.createElement("p");
            memoText.textContent = memo.text;
            memoElement.appendChild(memoText);

            // ë²„íŠ¼ë“¤ì„ ë‹´ì„ ê·¸ë£¹ ì»¨í…Œì´ë„ˆ
            const btnGroup = document.createElement("div");
            btnGroup.classList.add("btn-group");

            // [ì‚­ì œ] ë²„íŠ¼
            const deleteButton = document.createElement("button");
            deleteButton.textContent = "ì‚­ì œ";
            deleteButton.addEventListener("click", () => {
              memoElement.remove();
            });
            btnGroup.appendChild(deleteButton);

            // [ë¡œì»¬ ì €ì¥] ë²„íŠ¼
            const localSaveButton = document.createElement("button");
            localSaveButton.textContent = "ë¡œì»¬ ì €ì¥";
            localSaveButton.addEventListener("click", () => {
              localStorage.setItem(
                "memoStorage",
                JSON.stringify([
                  ...(JSON.parse(localStorage.getItem("memoStorage")) ?? []),
                  memo,
                ])
              );
              alert("ë©”ëª¨ê°€ ë¡œì»¬ì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.");
            });
            btnGroup.appendChild(localSaveButton);

            // [ì„¸ì…˜ ì €ì¥] ë²„íŠ¼
            const sessionSaveButton = document.createElement("button");
            sessionSaveButton.textContent = "ì„¸ì…˜ ì €ì¥";
            sessionSaveButton.addEventListener("click", () => {
              sessionStorage.setItem(
                "memoStorage",
                JSON.stringify([
                  ...(JSON.parse(sessionStorage.getItem("memoStorage")) ?? []),
                  memo,
                ])
              );
              alert("ë©”ëª¨ê°€ ì„¸ì…˜ì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.");
            });
            btnGroup.appendChild(sessionSaveButton);

            memoElement.appendChild(btnGroup);
            view.appendChild(memoElement);
          }
        }

        const controller = document.querySelector("#controller");
        controller.addEventListener("submit", function (event) {
          event.preventDefault();
          const form = new FormData(controller);
          const memo = {
            text: form.get("memoText"),
            bgColor: form.get("memoBgColor"),
          };
          memoData.push(memo);
          drawMemo();
          controller.reset();
          // ìƒˆë¡œìš´ ìƒ‰ìƒ ì ìš©
          document.querySelector("#colorInput").value = goodBgColor();
        });

        drawMemo();
      }
      onload();
    </script>
  </body>
</html>
